import{i as u,e as n,a as v,m as b,h as g,s as h,f as x}from"./funcoes-C9HBdHmr.js";import{l as y}from"./funcoes-CIA2kXgu.js";import"./index-D_cyGAQO.js";var c=u("editar_pergunta_tipo_empreendimento"),_=u("editar_pergunta_topico"),f=u("editar_pergunta_area"),m=u("editar_pergunta_tag"),l=1,p=[];$(document).on("click",".editar",function(){$("#editar_pergunta_tematica").empty(),axios.get("tematicas/lista").then(a=>{let t=a.data;for(let o in t){let e=t[o].ativo==!0?"Ativo":"Inativo",s=`<option value="${t[o].id}">${t[o].nome}(${e})</option>`;$("#editar_pergunta_tematica").append(s)}}).catch(a=>{n(a)}),axios.get("tipos_empreendimentos/lista").then(a=>{let t=a.data;for(let o in t){let e=t[o].ativo==!0?"Ativo":"Inativo";c.addOption({value:t[o].id,text:t[o].nome+`(${e})`})}}).catch(a=>n(a)),axios.get("topicos/lista").then(a=>{let t=a.data;for(let o in t){let e=t[o].ativo==!0?"Ativo":"Inativo";_.addOption({value:t[o].id,text:t[o].nome+`(${e})`})}}).catch(a=>n(a)),axios.get("areas/lista").then(a=>{let t=a.data;for(let o in t){let e=t[o].ativo==!0?"Ativo":"Inativo";f.addOption({value:t[o].id,text:t[o].nome+`(${e})`})}}).catch(a=>n(a)),axios.get("tags/lista").then(a=>{let t=a.data;for(let o in t){let e=t[o].ativo==!0?"Ativo":"Inativo";m.addOption({value:t[o].id,text:t[o].nome+`(${e})`})}}).catch(a=>n(a)),v("modal_editar_pergunta",!1);let r=$(this).attr("pergunta");axios.get("perguntas/detalhes/"+r).then(a=>{p=[],$("#editar_pergunta_fotos").empty();let t=a.data,o=!!a.data.ativo,e=[];for(let i in t.tipos_empreendimentos){let d=t.tipos_empreendimentos[i].tipo_empreendimento_id;e.push(d)}c.setValue(e),e=[];for(let i in t.topicos){let d=t.topicos[i].topico_id;e.push(d)}_.setValue(e),e=[];for(let i in t.areas){let d=t.areas[i].area_id;e.push(d)}f.setValue(e),e=[];for(let i in t.tags){let d=t.tags[i].tag_id;e.push(d)}m.setValue(e);let s=t.fotos;for(let i in s){let d=`<div id="foto${l}" class="max-w-sm bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">                            
                            <img class="rounded-t-lg" src="${app_url}/arquivos/exibir/${s[i].arquivo_id}" alt="" />                            
                            <div class="p-5">                                
                                <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">${s[i].legenda}</h5>                                
                                <button foto="foto${l}" foto_id="${s[i].id}" type="button" class="editar_pergunta_excluir_foto text-white bg-red-700 hover:bg-red-800 focus:outline-none focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900"><i class="fas fa-times"></i></button>
                            </div>
                        </div>`;$("#editar_pergunta_fotos").append(d),l++}$("#editar_pergunta_id").val(t.id),$("#editar_pergunta_titulo").val(t.titulo),$("#editar_pergunta_tematica").val(t.tematica_id),$("#editar_pergunta_ativo").prop("checked",o),b("modal_editar_pergunta")}).catch(a=>{n(a)})});$(document).on("click",".editar_pergunta_excluir_foto",function(){let r=$(this).attr("foto"),a=$(this).attr("foto_id");p.push(a),$("#"+r).remove()});$("#btn_editar_pergunta").click(function(){g("btn_editar_pergunta",!1);let r=new FormData;r.append("titulo",$("#editar_pergunta_titulo").val()),r.append("tematica_id",$("#editar_pergunta_tematica").val()),r.append("tipos_empreendimentos",$("#editar_pergunta_tipo_empreendimento").val()),r.append("areas",$("#editar_pergunta_area").val()),r.append("topicos",$("#editar_pergunta_topico").val()),r.append("tags",$("#editar_pergunta_tag").val()),r.append("ativo",$("#editar_pergunta_ativo").prop("checked")),r.append("fotos_para_excluir",p);let a=document.querySelectorAll(".foto_editar"),t=document.querySelectorAll(".legenda_editar");for(let e=0;e<t.length;e++)r.append("legendas[]",t[e].value?t[e].value:"");for(let e of a)e.files&&e.files[0]?r.append("fotos[]",e.files[0]):r.append("fotos[]",null);let o=$("#editar_pergunta_id").val();axios.post("perguntas/editar/"+o,r).then(e=>{h(e),y(),x("modal_editar_pergunta"),l=1,p=[]}).catch(e=>{n(e)}).finally(()=>{g("btn_editar_pergunta",!0)})});$("#btn_adicionar_foto_editar_pergunta").click(function(){let r=`<div id="foto${l}" class="my-2 border border-radius">                        
                        <input class="foto_editar mb-2 block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400" type="file" accept=".png, .jpg, .jpeg">
                        <input type="text"  class="legenda_editar block w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-xs focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Legenda...">
                        <button foto="foto${l}" type="button" class="adicionar_pergunta_excluir_foto text-white bg-red-700 hover:bg-red-800 focus:outline-none focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900"><i class="fas fa-times"></i></button>
                    </div>`;$("#editar_pergunta_fotos").append(r),l++});
