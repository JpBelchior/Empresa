import{h as s,s as d,e as g,a as _,m as f}from"./funcoes-Duew_XSt.js";import{a as i}from"./funcoes-D0T5GenN.js";import"./index-DEJP78qa.js";$(document).ready(function(){i(),l();let e="";for(let r in todas_perguntas){let t=`<div id="pergunta${todas_perguntas[r].id}" class="my-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700">    
                            <div class="p-5">        
                                <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">${todas_perguntas[r].titulo}</h5>                                        
                                <textarea placeholder="Resposta..." class="resposta p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Write your thoughts here..."></textarea>                                
                                <div class="flex items-start gap-4">
                                    <button id="btn_registrar_pergunta_id_${todas_perguntas[r].id}" propriedade="${todas_perguntas[r].id}" type="button" class="registrar flex justify-center mt-4 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">Registrar</button>                                
                                    <div>                                    
                                        <label class="block text-gray-700 font-bold mb-2" for="fileUpload">+ FOTO</label>
                                        <input
                                            id="foto${todas_perguntas[r].id}"
                                            type="file"                                            
                                            accept=".jpg, .jpeg, .png"
                                            class="foto block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-600 file:bg-blue-500 file:text-white file:py-2 file:px-4 file:rounded-lg file:border-none"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>`;e+=t}$("#todas_perguntas").append(e),$("#spinner").hide()});$(document).on("click",".registrar",function(){let e=$(this).attr("propriedade"),r=$("#pergunta"+e+" h5").html(),t=new FormData;if(t.append("titulo",r),t.append("pergunta_id",e),t.append("resposta",$("#pergunta"+e+" .resposta").val()),t.append("formulario_id",$("#formulario_id").val()),t.append("foto",document.getElementById("foto"+e).files[0]),s("btn_registrar_pergunta_id_"+e,!1),o==!1){let a="";if(dados.resposta==""&&(a+="Resposta é obrigatório!"),a!=""){new Swal({title:"Erro!",icon:"error",text:a}),s("btn_registrar_pergunta_id_"+e,!0);return}b(dados),Swal.mixin({toast:!0,position:"top-start",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:u=>{u.onmouseenter=Swal.stopTimer,u.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Resposta adiciona na fila de espera!"}),s("btn_registrar_pergunta_id_"+e,!0);return}axios.post("/formularios/registrar",t).then(a=>{d(a.data.mensagem),$("#qtd_perguntas_respondidas").html(`(${a.data.qtd})`)}).catch(a=>{g(a)}).finally(()=>{s("btn_registrar_pergunta_id_"+e,!0)})});$("#btn_perguntas_respondidas").click(function(){_("modal_perguntas_respondidas",!1),i(),f("modal_perguntas_respondidas")});$(document).on("click",".excluir_resposta",function(){let e=$(this).attr("resposta");s("excluir_resposta"+e,!1),axios.delete(app_url+"/formularios/excluir/resposta/"+e).then(r=>{d(r),i()}).catch(r=>{g(r)}).finally(()=>{f("excluir_resposta"+e)})});var p=[],o=!0;function n(e){e?($("#online").removeClass("bg-red-50"),$("#online").addClass("bg-green-50"),$("#online").html("ONLINE")):($("#online").removeClass("bg-green-50"),$("#online").addClass("bg-red-50"),$("#online").html("OFFLINE"))}function m(){const e=new XMLHttpRequest;e.open("GET",url,!0),e.timeout=5e3,e.onload=function(){e.status>=200&&e.status<300?(o=!0,n(!0)):(o=!1,n(!1))},e.onerror=function(){o=!1,n(!1)},e.ontimeout=function(){o=!1,n(!1)},e.send()}setInterval(m,200);setInterval(h,2e3);function b(e){p.push(e),localStorage.setItem("dados",JSON.stringify(p)),l()}function c(){return JSON.parse(localStorage.getItem("dados"))}function l(){let e=c();$("#perguntas_em_espera_qtd").html(`(${e.length})`),$("#perguntas_respondidas_em_espera").empty();for(let r in e){let t=`<li class="list-group-item">${e[r].titulo}: ${e[r].resposta}</li>`;$("#perguntas_respondidas_em_espera").append(t)}}function h(){if(o===!1)return;let e={dados:c()};e.dados.length>0&&axios.post(app_url+"/formularios/registrar_perguntas_em_espera/"+$("#formulario_id").val(),e).then(r=>{localStorage.setItem("dados",JSON.stringify([])),i(),l(),d("Respostas em espera foram cadastradas!")})}
