<% if (dadosLista && dadosLista.temLista) { %> <%
dadosLista.paginasLista.forEach((pagina, indicePagina) => { %>

<!-- PÁGINA <%= pagina.numeroPagina %> DAS NÃO CONFORMIDADES -->
<div class="min-h-screen flex flex-col bg-white text-black">
    <!-- HEADER -->
    <%- include('header', { numeroPagina: pagina.numeroPaginaExibicao +1 ,
    tituloSecao: 'NÃO CONFORMIDADES - NC' }) %>

    <!-- CONTEÚDO -->
    <div class="px-8 py-6">
        <!-- TABELA -->
        <div
            class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm"
        >
            <table class="w-full table-fixed border-collapse">
                <colgroup>
                    <col style="width: 27%" />
                    <col style="width: 9%" />
                    <col style="width: 46%" />
                    <col style="width: 18%" />
                </colgroup>
                <thead>
                    <tr>
                        <th
                            class="px-4 py-5 text-center text-sm font-semibold bg-sky-800 text-white border border-blue-500"
                        >
                            Pilar
                        </th>
                        <th
                            class="px-4 py-3 text-center text-sm font-semibold bg-sky-800 text-white border border-blue-500"
                        >
                            NC
                        </th>
                        <th
                            class="px-4 py-3 text-center text-sm font-semibold bg-sky-800 text-white border border-blue-500"
                        >
                            Não Conformidade
                        </th>
                        <th
                            class="px-4 py-3 text-center text-sm font-semibold bg-sky-800 text-white border border-blue-500"
                        >
                            Criticidade
                        </th>
                    </tr>
                </thead>

                <tbody>
                    <% const pils = [ { imagem: imagens.pessoas, chave:
                    "Pessoas" }, { imagem: imagens.tecnologia, chave:
                    "Tecnologia" }, { imagem: imagens.processos, chave:
                    "Processos" }, { imagem: imagens.informacoes, chave:
                    "Informação" }, { imagem: imagens.gestao, chave: "Gestão" }
                    ]; %> <% pagina.itens.forEach((item, indiceItem) => { const
                    pilar = pils[indiceItem % pils.length]; let corCriticidade =
                    ''; if (item.criticidade === 'vermelho-escuro')
                    corCriticidade = 'bg-red-500'; else if (item.criticidade ===
                    'laranja') corCriticidade = 'bg-orange-500'; else if
                    (item.criticidade === 'amarelo') corCriticidade =
                    'bg-yellow-500'; else if (item.criticidade ===
                    'verde-escuro') corCriticidade = 'bg-green-700'; else if
                    (item.criticidade === 'verde-claro') corCriticidade =
                    'bg-green-400'; else corCriticidade = 'bg-gray-500'; %>
                    <tr
                        class="<%= indiceItem % 2 === 0 ? 'bg-gray-100' : 'bg-white' %> hover:bg-blue-50"
                    >
                        <!-- PILAR -->
                        <td
                            class="px-4 py-3 text-center align-middle border border-blue-500"
                        >
                            <div
                                class="w-full h-10 flex items-center justify-center bg-blue-50 rounded-sm"
                            >
                                <% if (pilar.imagem) { %>
                                <img
                                    src="<%= pilar.imagem %>"
                                    alt="<%= pilar.chave %>"
                                    class="w-[90%] h-full object-contain transform scale-[1.2]"
                                />
                                <% } else { %>
                                <div
                                    class="w-8 h-8 bg-blue-500 rounded-full"
                                ></div>
                                <% } %>
                            </div>
                        </td>

                        <!-- NC -->
                        <td
                            class="px-4 py-3 text-center align-middle border border-blue-500"
                        >
                            <span
                                class="inline-block bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-mono font-bold"
                            >
                                <%= item.nc %>
                            </span>
                        </td>

                        <!-- NÃO CONFORMIDADE -->
                        <td
                            class="px-4 py-3 border border-blue-500 text-center align-middle text-sm text-gray-900"
                        >
                            <%= item.naoConformidadeTexto %>
                        </td>

                        <!-- CRITICIDADE -->
                        <td
                            class="px-4 py-3 text-center align-middle border border-blue-500"
                        >
                            <div class="flex items-center justify-center">
                                <div
                                    class="w-7 h-7 rounded-full <%= corCriticidade %>"
                                ></div>
                            </div>
                        </td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>

        <!-- INFORMAÇÕES DA PÁGINA -->
        <div
            class="mt-4 flex justify-between items-center text-sm text-gray-600"
        >
            <span
                >Página <%= pagina.numeroPagina %> de <%= pagina.totalPaginas %>
                - Não Conformidades</span
            >
            <span
                >Itens <%= pagina.indiceInicio %> - <%= pagina.indiceFim %> de
                <%= pagina.totalItens %></span
            >
        </div>

        <!-- LEGENDA -->
        <div class="mt-6 flex flex-col items-center space-y-4">
            <!-- LEGENDA DOS PILARES -->
            <div
                class="border-blue-400 border-2 rounded-lg p-4 flex justify-center w-full"
            >
                <div class="flex gap-6">
                    <% pils.forEach(p => { %>
                    <div class="flex items-center gap-1 text-xs">
                        <img
                            src="<%= p.imagem %>"
                            alt="<%= p.chave %>"
                            class="w-10 h-10 object-contain"
                        />
                        <span class="font-semibold"><%= p.chave %></span>
                    </div>
                    <% }) %>
                </div>
            </div>

            <!-- LEGENDA DAS CORES DE CRITICIDADE -->
            <div
                class="border-blue-400 border-2 rounded-lg p-4 flex justify-center w-full"
            >
                <div class="flex gap-6">
                    <% const cores = [ { cor: 'bg-red-500', corTexto:
                    'text-red-500', nome: 'Crítico' }, { cor: 'bg-orange-500',
                    corTexto: 'text-orange-500', nome: 'Alto' }, { cor:
                    'bg-yellow-500', corTexto: 'text-yellow-500', nome: 'Médio'
                    }, { cor: 'bg-green-700', corTexto: 'text-green-700', nome:
                    'Baixo' }, { cor: 'bg-green-400', corTexto:
                    'text-green-400', nome: 'Muito Baixo' } ]; %> <%
                    cores.forEach(c => { %>
                    <div class="flex items-center gap-3 text-xs">
                        <div class="w-5 h-5 rounded-full <%= c.cor %>"></div>
                        <span class="<%= c.corTexto %> font-semibold"
                            ><%= c.nome %></span
                        >
                    </div>
                    <% }) %>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <%- include('footer', { dados: dados }) %>
</div>

<% }); %> <% } else { %>
<!-- Se não houver não conformidades, não exibe nada -->
<% } %>
